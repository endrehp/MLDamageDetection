function COMAC = getCOMAC(U, V)

    % This function returns the COMAC vector for two sets of mode shapes
    
    Ut = U';
    Vt = V';
    M = length(U(:,1)); % Number of dofs
    N = length(U(1,:)); % Number of mode shapes
    
    COMAC = zeros(1,N);
    for i = 1:N
        
        for j=1:

            a = U(i,j)*V(i,j);
            b1 = U(i,j)*Ut(i,j); 
            b2 = V(i,j)*Vt(i,j);
        end
        
        COMAC(i) = a^2/(b1*b2);    
    end
    